<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
    <title>Epifai Name Manager</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <style>
        body { font-family: Segoe UI, Arial, sans-serif; margin: 20px; background: #fff; }
        h1 { color: #333; font-size: 18px; }
        #status { padding: 10px; border-radius: 4px; margin: 10px 0; }
        .loading { background: #fff3cd; color: #856404; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Epifai Name Manager</h1>
    <p id="status" class="loading">Initializing Office.js...</p>
    <p id="info"></p>
    <script type="text/javascript">
        try {
            Office.onReady(function(info) {
                var el = document.getElementById('status');
                el.textContent = 'Connected to Excel! Host: ' + (info.host || 'unknown') + ', Platform: ' + (info.platform || 'unknown');
                el.className = 'success';
                document.getElementById('info').textContent = 'The add-in is working. You can now switch to the full app.';
            });
        } catch(e) {
            var el = document.getElementById('status');
            el.textContent = 'Error: ' + e.message;
            el.className = 'error';
        }
        setTimeout(function() {
            var el = document.getElementById('status');
            if (el.className === 'loading') {
                el.textContent = 'Office.js timed out. Page loaded but Office context not available.';
                el.className = 'error';
                document.getElementById('info').textContent = 'URL: ' + window.location.href;
            }
        }, 10000);
    </script>
</body>
</html>
